# SA-RSR-in-Ceph
SA-RSR: A Low-overhead Data Recovery Strategy for XOR-Coded Distributed Storage Systems
# abstract
To ensure the reliability and availability of data, redundancy strategies are always indispensable for distributed storage systems. As one of the generally-used redundancy strategies, erasure code has the advantage of low storage overhead which facilitates its employment in distributed storage systems. While among the various erasure codes, XOR-based erasure codes are becoming popular due to their fast computing speed. When some nodes fail in such a coded scheme, a process of data recovery takes place decoding for the lost data from the surviving ones, however, during which the data transmission consumes a considerable amount of time. To reduce the time consumed by data transmission, current researches mainly focus on reducing the data amount needed for data recovery but encounter problems such as high complexity and local optima. In this paper, we propose SA-RSR—a random search recovery algorithm for speeding up single-node failure recovery of XOR-based erasure codes—which uses a simulated annealing technique to search for a globally optimal recovery solution that uses a minimum amount of data and this search process can be done in polynomial time. We implement and evaluate SA-RSR in both simulations with a variety of XOR-based erasure codes and a real system Ceph. Experiments show that SA-RSR reduces the data amount required for recovery by 20%-30% and improves the performance of data recovery by 13%-20% in Ceph, compared with the conventional recovery method.
# SA-RSR
To integrate SA-RSR in the distributed storage system Ceph, we reconstruct the execution logic of the data recovery process of the Ceph erasure code.Figure shows the architecture of our implementation. During data recovery, Ceph frst selects one OSD node to perform data recovery operations—usually the primary OSD node in the PG. We refer to this OSD as the recovery node.
![image](https://github.com/lyfdamon/SA-RSR-in-Ceph/blob/master/images/architecture.png)
According to the coding scheme in the PG and the number and location of the failed nodes, Ceph selects k surviving nodes to participate in the data recovery operation, including data nodes and parity nodes. In our design, when performing data recovery, we have the Recovery Scheduling Module with which Ceph executes SA-RSR on the recovery node to obtain a symbol reading scheme with the smallest amount of data, which corresponds to the surviving nodes in the PG. According to the symbol reading scheme, the recovery node constructs a reading request for each node involved in the data recovery process. Once the reading requests are built, they are sent to corresponding nodes.
A Recovery Read Handler runs on each surviving node and handles the read requests sent by the recovery node. The OSD Daemons in Ceph are responsible for reading data blocks from the disk. Based on this system design, the Recovery Read Handler performs data read operations according to the messages in the read requests, which contain the ids of the symbols that the current node needs to read. All symbols needed for data recovery are sent back to the recovery node.
The missing data can be obtained by the decoding operation of the Decoding Module. Ceph uses an erasure code plug-in infrastructure that enables dynamical use of external erasure code libraries, while the XOR-based erasure codes are implemented in the Jerasure-2.0 Library in Ceph. Therefore, we improve the decoding part of the Jerasure Library to ensure that it can decode the lost data with less data.
